.slide-icon.prev
  %a{href: "#"}
    %span.glyphicon.glyphicon-chevron-left

.cart{id: "cart_#{cart.id}"}
  .name
    =link_to cart.name, cart
    .subname.active
      %a{href: "#", "data-target-class" => "first"} Info
    .subname
      %a{href: "#", "data-target-class" => "second"} Menu
    .subname
      %a{href: "#", "data-target-class" => "third"} Reviews
    .subname
      %a{href: "#", "data-target-class" => "fourth"} Checkins
  .content.first
    .info.section
      .col-lg-3
        .photo
          -if cart.photos.first
            =image_tag(asset_path("cw-logo-no-text.jpg"))
            //=image_tag(cart.photos.first.image_url)
          -else
            =image_tag(asset_path("cw-logo-no-text.jpg"))
        .rating{"data-score" => cart.rating }
        .categories
          -if cart.categories.first
            -cart.categories[0..2].each do |item|
              .item
                =link_to item.name, "#"
        -if cart.categories.count > 3
          =link_to "#{cart.categories[3..-1].count} more", "#", {"data-toggle" => "modal", "data-target" => "#categories-modal-#{cart.id}", :class => "more-link"}
        -else
          =link_to "Add a category", "#", {"data-toggle" => "modal", "data-target" => "#categories-modal-#{cart.id}", :class => "more-link"}
        .modal.fade.categories-modal{id: "categories-modal-#{cart.id}", "aria-hidden" => "true", "role" => "dialog", "tabindex" => -1}
          .modal-dialog
            .modal-content
              .modal-header
                %button.close{"data-dismiss" => "modal", type: "button"}
                  %span{"aria-hidden" => "true"} ×
                  %span.sr-only Close
                %h3.modal-title="Categories - #{cart.name}"
              .modal-body
                .categories
                  -cart.categories.each do |item|
                    .item
                      =link_to item.name, "#"

                =render partial: "cart_category_relations/form", locals: {ccr: CartCategoryRelation.new, cart: cart}
      .col-lg-5
        .location
          .map
            = image_tag "http://maps.google.com/maps/api/staticmap?size=250x200&sensor=false&zoom=14&markers=#{cart.lat}%2C#{cart.lon}"

          .meta
            //Find a way to specify what's streets between
            .address
              .col-lg-2
                .address-heading Near
              .col-lg-9
                =link_to cart.address, "#", {"data-toggle" => "modal", "data-target" => "#directions-modal-#{cart.id}", class: "directions-link"}

        .modal.fade.directions-modal{id: "directions-modal-#{cart.id}", "aria-hidden" => "true", "role" => "dialog", "tabindex" => -1}
          .modal-dialog
            .modal-content
              .modal-header
                %button.close{"data-dismiss" => "modal", type: "button"}
                  %span{"aria-hidden" => "true"} ×
                  %span.sr-only Close
                %h3.modal-title="Directions to #{cart.name}"
              .modal-body
                .wheels-form
                  .form-group
                    .row
                      .form-label Start address
                    .row
                      %input.form-input#address{placeholder: "225 smith street, 5 cherry lane"}
                .directions-map{id: "directions-map-#{cart.id}", "data-latitude" => cart.lat, "data-longitude" => cart.lon}
                .directions-panel{id: "directions-panel-#{cart.id}"}


      .col-lg-4
        .hours
          -if cart.hours.first
            .hours-heading Hours
            -cart.hours.order(:day).each do |item|
              .item.row
                .day.col-lg-3=n_to_day(item.day)
                .start.col-lg-4=n_to_time(item.start)
                .bridge.col-lg-1 To
                .end.col-lg-4=n_to_time(item.end)
          -else
            .hours-heading.warning No hours available
          -if cart.hours.count < 7
            .add-hours.wheels-form
              =form_for Hour.new, remote: true, url: cart_hours_path(cart), html: {'data-model' => 'hour', :class => "form-inline"} do |f|
                .form-group
                  .row
                    =f.select :day, options_for_select(day_options, 1), {}, {class: "form-control"}
                    =f.select :start, options_for_select(time_options, "0800"), {}, {class: "form-control"}
                    =f.select :end, options_for_select(time_options, "1700"), {}, {class: "form-control"}
                  .row
                    = f.submit "Submit", class: "btn btn-primary cart-btn"

    //Slideshow form default, list form when expands
    .menu.section
      .row
        -if cart.menu.menu_items.first
          .col-lg-4
            .notes
              Notes
          .col-lg-2.carousel.slide{id: "menu-carousel-#{cart.id}", "data-ride" => "carousel"}
            %ol.carousel-indicators
              -(0...cart.menu.menu_items.count).each do |i|
                -if i == 0
                  %li.active{"data-slide-to" => "0", "data-target" => "#menu-carousel-#{cart.id}"}
                -else
                  %li{"data-slide-to" => "#{i}", "data-target" => "#menu-carousel-#{cart.id}"}
            .carousel-inner
              -cart.menu.menu_items.each do |item|
                -if item == cart.menu.menu_items.first
                  .item.active{id: "#{item.id}"}
                    .name=item.name
                    -if item.photo
                      =image_tag(item.photo.image_url_small)
                    .carousel-caption
                      .price="$#{item.price}"
                -else
                  .item{id: "#{item.id}"}
                    .name=item.name
                    -if item.photo
                      =image_tag(item.photo.image_url_small)
                    .carousel-caption
                      .price="$#{item.price}"
            %a.left.carousel-control{"data-slide" => "prev", href: "#menu-carousel-#{cart.id}", role: "button"}
              %span.glyphicon.glyphicon-circle-arrow-left
            %a.right.carousel-control{"data-slide" => "next", href: "#menu-carousel-#{cart.id}", role: "button"}
              %span.glyphicon.glyphicon-circle-arrow-right
          .col-lg-4
            .notes
              Notes

    .reviews.section
      -cart.reviews[0..5].each do |review|
        .item
          .rating{'data-score' => review.rating}
          .user=review.user.name
          .date=time_ago_in_words(review.updated_at) + " ago"
          .text=review.text

    .checkins.section
      -cart.checkins[0..10].each do |checkin|
        .item
          .photo
            -if checkin.photos.first
              %a.pop-image.pop-image-top{href: "#", "data-title" => checkin.user.name, "data-content" => checkin.description}
                =image_tag(checkin.photos.first.image_url_thumb)

  .expand
.slide-icon.next
  %a{src: "#"}
    %span.glyphicon.glyphicon-chevron-right

